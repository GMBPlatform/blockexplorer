"use strict";var walletState={status:!1},transferId=1,initWallet=function(){},requestRender=function(e,t,r,a,n){$.ajax({type:e,data:n,url:"https://www.gmbplatform.io/blockexplorer/wallet/".concat(t,"/").concat(r),success:null===a?function(){}:a})},alertHandler=function(e,t){$("#".concat(e)).text(t),$("#".concat(e)).show(),setTimeout(function(){$("#".concat(e)).hide()},2e3)},appendTransfer=function(){transferId++,$("#transfer_form").append('\n  <div id="transfer_'.concat(transferId,'" class="transfer-form__inner">\n    <div class="row wallet-row-wrapper">\n      <div class="col-lg-12 ">\n        <div style="display:flex; justify-content: space-between;">\n          <div class="transfer-title">받는 지갑 주소</div>\n          <div>\n            <a\n              id="remove_').concat(transferId,'"\n              onclick="removeTransfer(this.id)"\n              style="color:#a6a6a6; margin:0px 0px 0px 5px; font-size:15px;"\n              onmouseover="$(this).css(\'text-decoration\', \'underline\'); $(this).css(\'cursor\', \'pointer\');"\n              onmouseout="$(this).css(\'text-decoration\', \'none\');"\n            >\n              해당 정보 삭제\n            </a>\n          </div>\n        </div>\n        <input name="wallet_to" type="text" placeholder="From" class="form-control" maxlength="70" />\n      </div>\n    </div>\n    <div class="row wallet-row-wrapper">\n      <div class="col-lg-6 ">\n        <div class="transfer-title">보낼 금액</div>\n        <input\n          name="wallet_amount"\n          type="number"\n          placeholder="Amount"\n          class="form-control"\n          maxlength="20"\n        />\n      </div>\n      <div class="col-lg-6 ">\n        <div class="transfer-title">수수료</div>\n        <input name="wallet_fee" type="number" placeholder="Fee" class="form-control" maxlength="20" />\n      </div>\n    </div>\n  </div>\n  '))},removeTransfer=function(e){$("#".concat($("#".concat(e)).parents("div")[4].id)).remove()},fileUploadOnChange=function(){$("#file_upload_span").text($("#upload-files-default").prop("files")[0].name)},buttonLoader=function(e,t){t?($("#".concat(e)).addClass("is-loading"),$("#".concat(e)).attr("disabled",!0)):($("#".concat(e)).removeClass("is-loading"),$("#".concat(e)).attr("disabled",!1))},sideBarOnClick=function(e){function t(e){$("#dynamic-form").html(e)}switch(e){case"wallet_generate":requestRender("post","page","generate",t);break;case"wallet_information":if(!walletState.status)return;requestRender("post","page","information",t,walletState);break;case"load_keyfile":requestRender("post","page","load/keyfile",t);break;case"load_direct":requestRender("post","page","load/direct",t);break;case"transfer":requestRender("post","page","transaction/transfer",t);break;case"smart_contract":requestRender("post","page","transaction/contract",t)}},innerSubmitButtonOnClick=function(r){switch(r){case"wallet_generate_button":var e=$("#wallet_password").val(),t=$("#wallet_mnemonic").val();if(256<t.length||t.length<8)return void alertHandler("wallet_generate_alert","사용자 정의 문장은 8글자 이상 256글자 이하여야 합니다.");if(20<e.length||e.length<8)return void alertHandler("wallet_generate_alert","비밀번호는 8글자 이상 20글자 이하여야 합니다.");var a={mnemonic:t,password:e};buttonLoader(r,!0),requestRender("post","api","generate",function(e){isIE()?saveToFileIE("".concat((new Date).getTime(),".json"),JSON.stringify(e.keyFile)):saveToFileChrome("".concat((new Date).getTime(),".json"),JSON.stringify(e.keyFile)),walletState.status=!0,walletState.walletInfo=e,$("#need_wallet_form").css("display","block"),buttonLoader(r,!1),sideBarOnClick("wallet_information")},a);break;case"load_keyfile_button":var n=$("#wallet_password").val(),o=$("#upload-files-default").prop("files")[0];if(20<n.length||n.length<8)return void alertHandler("wallet_keyfile_alert","비밀번호는 8글자 이상 20글자 이하여야 합니다.");if("application/json"!==o.type)return void alertHandler("wallet_keyfile_alert","키 파일의 확장자명이 json이 아닙니다.");var l=new FileReader;l.onload=function(){try{if(void 0===l.result)return void alertHandler("wallet_keyfile_alert","잘못된 키 파일입니다.(1)");var e=JSON.parse(Base64.decode(JSON.parse(l.result).content));if(e.password!==sha256(n))return void alertHandler("wallet_keyfile_alert","잘못된 비밀번호입니다. 확인 후 다시 입력해주세요.");e.password=n,buttonLoader(r,!0),requestRender("post","api","load/keyfile",function(e){walletState.status=!0,walletState.walletInfo=e,$("#need_wallet_form").css("display","block"),buttonLoader(r,!1),sideBarOnClick("wallet_information")},e)}catch(e){alertHandler("wallet_keyfile_alert","잘못된 키 파일입니다.(2)")}},l.readAsText(o,"utf-8");break;case"load_direct_button":var i=$("#wallet_password").val(),s=$("#wallet_mnemonic").val(),c=$("#wallet_random").val();if(256<s.length||s.length<8)return void alertHandler("wallet_direct_alert","사용자 정의 문장은 8글자 이상 256글자 이하여야 합니다.");if(20<i.length||i.length<8)return void alertHandler("wallet_direct_alert","비밀번호는 8글자 이상 20글자 이하여야 합니다.");var d={mnemonic:s,password:i,randomNumber:c};buttonLoader(r,!0),requestRender("post","api","load/direct",function(e){walletState.status=!0,walletState.walletInfo=e,$("#need_wallet_form").css("display","block"),buttonLoader(r,!1),sideBarOnClick("wallet_information")},d);break;case"transfer_button":for(var f=$("#wallet_from").val(),u=$("#wallet_private_key").val(),_=[],h=$("input[name=wallet_amount]"),w=$("input[name=wallet_to]"),p=$("input[name=wallet_fee]"),v=0,m=0;m<w.length;m++){var g=h.eq(m).val(),C=w.eq(m).val(),b=p.eq(m).val();if(""===g||""===C||""===b)return void alertHandler("wallet_transfer_alert","비어있는 항목이 존재합니다");66!==C.length&&alertHandler("wallet_transfer_alert","받는 지갑 주소 중 잘못된 항목이 존재합니다. 지갑 주소는 66글자여야 합니다."),v+=Number(g)+Number(b),_.push({To:C,Fee:b,Kind:1,Amount:g})}requestRender("post","api","balance",function(e){if(e.balance<v)alertHandler("wallet_transfer_alert","잔액이 부족합니다.");else if(66===f.length)if(64===u.length){var t={from:f,note:_,privateKey:u};buttonLoader(r,!0),requestRender("post","api","transaction/transfer",function(e){"success"===e.res?(alertHandler("wallet_transfer_alert_success","송금되었습니다."),setTimeout(function(){buttonLoader(r,!1),sideBarOnClick("transfer"),location.href="/blockexplorer/search/transaction?key=".concat(e.hash)},1e3)):(alertHandler("wallet_transfer_alert","송금이 실패하였습니다. 입력 항목을 확인하세요."),buttonLoader(r,!1))},t)}else alertHandler("wallet_transfer_alert","잘못된 개인 키 입니다.");else alertHandler("wallet_transfer_alert","잘못된 지갑주소입니다. 보내는 지갑 주소를 올바르게 입력하세요.")},{address:f})}},saveToFileChrome=function(e,t){var r=new Blob([t],{type:"json"});objURL=window.URL.createObjectURL(r),window.__Xr_objURL_forCreatingFile__&&window.URL.revokeObjectURL(window.__Xr_objURL_forCreatingFile__),window.__Xr_objURL_forCreatingFile__=objURL;var a=document.createElement("a");a.download=e,a.href=objURL,a.click()},saveToFileIE=function(e,t){var r=new Blob([t],{type:"json",endings:"native"});window.navigator.msSaveBlob(r,e)},isIE=function(){return"Netscape"===navigator.appName&&-1!==navigator.userAgent.search("Trident")||-1!==navigator.userAgent.toLowerCase().indexOf("msie")},Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,a,n,o,l,i,s="",c=0;for(e=Base64._utf8_encode(e);c<e.length;)n=(t=e.charCodeAt(c++))>>2,o=(3&t)<<4|(r=e.charCodeAt(c++))>>4,l=(15&r)<<2|(a=e.charCodeAt(c++))>>6,i=63&a,isNaN(r)?l=i=64:isNaN(a)&&(i=64),s=s+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(l)+this._keyStr.charAt(i);return s},decode:function(e){var t,r,a,n,o,l,i="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=this._keyStr.indexOf(e.charAt(s++))<<2|(n=this._keyStr.indexOf(e.charAt(s++)))>>4,r=(15&n)<<4|(o=this._keyStr.indexOf(e.charAt(s++)))>>2,a=(3&o)<<6|(l=this._keyStr.indexOf(e.charAt(s++))),i+=String.fromCharCode(t),64!=o&&(i+=String.fromCharCode(r)),64!=l&&(i+=String.fromCharCode(a));return i=Base64._utf8_decode(i)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t},_utf8_decode:function(e){for(var t="",r=0,a=c1=c2=0;r<e.length;)(a=e.charCodeAt(r))<128?(t+=String.fromCharCode(a),r++):191<a&&a<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&a)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&a)<<12|(63&c2)<<6|63&c3),r+=3);return t}},sha256=function(e){function $(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function A(e,t){return e>>>t|e<<32-t}function x(e,t){return e>>>t}return function(e){for(var t="0123456789abcdef",r="",a=0;a<4*e.length;a++)r+=t.charAt(e[a>>2]>>8*(3-a%4)+4&15)+t.charAt(e[a>>2]>>8*(3-a%4)&15);return r}(function(e,t){var r,a,n,o,l,i,s,c,d,f,u,_,h,w,p,v,m,g,C=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),b=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),y=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var k=0;k<e.length;k+=16){r=b[0],a=b[1],n=b[2],o=b[3],l=b[4],i=b[5],s=b[6],c=b[7];for(var S=0;S<64;S++)y[S]=S<16?e[S+k]:$($($(A(g=y[S-2],17)^A(g,19)^x(g,10),y[S-7]),A(m=y[S-15],7)^A(m,18)^x(m,3)),y[S-16]),d=$($($($(c,A(v=l,6)^A(v,11)^A(v,25)),(p=l)&i^~p&s),C[S]),y[S]),f=$(A(w=r,2)^A(w,13)^A(w,22),(u=r)&(_=a)^u&(h=n)^_&h),c=s,s=i,i=l,l=$(o,d),o=n,n=a,a=r,r=$(d,f);b[0]=$(r,b[0]),b[1]=$(a,b[1]),b[2]=$(n,b[2]),b[3]=$(o,b[3]),b[4]=$(l,b[4]),b[5]=$(i,b[5]),b[6]=$(s,b[6]),b[7]=$(c,b[7])}return b}(function(e){for(var t=Array(),r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<24-r%32;return t}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t}(e)),8*e.length))};